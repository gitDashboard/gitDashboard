<div class="">
	<div class="ui icon menu attached  blue inverted " >
		<a class="item" ng-click="returnToFolder()">
			<i class="up big arrow icon"  />
		</a>
		<a class="item" ng-show="getUser().IsAdmin()" title="manage permissions" ng-click="getPermissions();currView='public/fragment/repo/permission.html';">
			<i class=" big icons">
				<i class="user icon"   />
				<i class="corner green lock icon"   />
			</i>
		</a>
	</div>
	<div ng-include="currView"></div>

	<div class="ui segment  attached">
		<b>Path:</b>{[{repo.path}]} <b><br/>
		Description:</b>{[{repo.description}]}<br/>
		<b>Url:</b>{[{repo.url}]}

	</div>
	<div class="ui segment attached">
		<div class="ui top attached tabular menu" id="repoTab">
			<a class="active item" data-tab="commits"><i class="ui code icon"/>Commits</a>
			<a class="item" data-tab="files"><i class="ui file outline icon"/>Files</a>
			<a class="item" data-tab="graph"><i class="ui fork icon"/>Branches Graph</a>
		</div>
		<div class="ui bottom attached active tab segment" data-tab="commits">
			<div>
				<div class="ui grid">
					<div class="ten wide column">
						<div class="ui selection dropdown" id="refSel">
							<input type="hidden" name="currRefFld" ng-model="currRef">
							<i class="dropdown icon"></i>
							<div class="default text">{[{currRef}]}</div>
							<div class="menu">
								<div class="item"  ng-repeat="ref in repo.references" data-value="{[{ref}]}">{[{ref}]}</div>
							</div>
						</div>
						<script type="text/javascript">
							$('#refSel').dropdown({
								onChange: function (value, text, choice) {
									$(this).scope().currRef = value;
									$(this).scope().getCommits();
									$(this).scope().getFiles(null);
								}
							});
						</script>
					</div>
					<div class="six wide column right aligned">
						<i class="ui backward icon" style="cursor:pointer;" ng-click="decPage()"/>
						<div class="ui left labeled input">
							<div class="ui basic label">
								page
							</div>
							<input type="number" ng-model="page" ng-change="getCommits()" style="width:60px;" />
						</div>
						<i class="ui forward icon" style="cursor:pointer;" ng-click="incPage()"/>
					</div>
				</div>
			</div>
			<div class="ui three columns grid segment ">
				<div class="blue row" style="border:1px solid #CCCCCC;">
					<div  class="three wide column" ><b>Date</b></div>
					<div  class="four wide column" ><b>Author</b></div>
					<div  class="nine wide column" ><b>Message</b></div>
				</div>
				<div class="row" style="border-bottom:1px solid #CCCCCC;" ng-repeat="commit in commits">
					<div  class="three wide column middle aligned" >{[{commit.date | date:'medium'}]}</div>
					<div  class="four wide column" >
						<div class="ui grid">
							<div class="four wide column">
								<img gravatar-src="commit.email" gravatar-size="40" class="ui image middle aligned" style="margin-right:5px;">
							</div>
							<div class="twelve wide column">
								{[{commit.author}]}<br/>
								{[{commit.email}]}
							</div>
						</div>
					</div>
					<div  class="nine wide column middle aligned" style="overflow:auto;">{[{commit.message}]}</div>
				</div>
			</div>
			<div   class="ui attached basic container" style="text-align:right;">
				<select ng-model="count" ng-change="getCommits()" class="ui compact selection dropdown" style="padding-bottom:0px;padding-top:0px;padding-right:5px;">
					<option value="10" ng-selected="count==10">10</option>
					<option value="20" ng-selected="count==20">20</option>
					<option value="50" ng-selected="count==50">50</option>
					<option value="100" ng-selected="count==100">100</option>
				</select>
			</div>
			
		</div>
		<div class="ui bottom attached  tab segment" data-tab="files">
			<div>
				<div class="ui selection dropdown" id="refFileSel" ng-class="{disabled:showFile}">
					<input type="hidden" name="currRefFld" ng-model="currRef">
					<i class="dropdown icon"></i>
					<div class="default text">{[{currRef}]}</div>
					<div class="menu">
						<div class="item"  ng-repeat="ref in repo.references" data-value="{[{ref}]}">{[{ref}]}</div>
					</div>
				</div>
				<script type="text/javascript">
					$('#refFileSel').dropdown({
						onChange: function (value, text, choice) {
							$(this).scope().currRef = value;
							$(this).scope().getCommits();
							$(this).scope().getFiles(null);
						}
					});
				</script>
				<i ng-show="showFile" class="ui left arrow blue icon clickable" ng-click="showFile=false;file=null;"/> {[{getPath()}]}
			</div>
			<div class="ui segment"  ng-hide="showFile">
				<div class="ui two columns grid">
					<div class="blue row">
						<div class="column"><b>Name</b></div>
						<div class="column"><b>Last commit</b></div>	
					</div>				
					<div class="row" ng-show="inFolder()" style="border-bottom:1px solid #CCCCCC;">
						<div class="clickable column" ng-click="upFilesDir()">
							<a><i class="ui up arrow icon"/></a>
						</div>
						<div></div>
					</div>
					<div class="row" ng-repeat="file in files" style="border-bottom:1px solid #CCCCCC;">
						<div class="column clickable" ng-click="openFile(file)">
							<i class="ui folder orange icon" ng-show="file.isDir"/>
							<i class="ui file outline icon" ng-hide="file.isDir"/>
							{[{file.name}]}
						</div>
						<div></div>
					</div>
				</div>
			</div>
			<div class="ui segment" ng-show="showFile" style="height:1000px;">
				<textarea  id="fileContentTxtArea" ng-model="file.content" rows="100"></textarea>
				<script type="text/javascript">
					var fileEditor = CodeMirror.fromTextArea(document.getElementById("fileContentTxtArea"),{
						lineNumbers: true,
						matchBrackets: true,
						readOnly:true,
						extraKeys: {
							"F11": function(cm) {
								cm.setOption("fullScreen", !cm.getOption("fullScreen"));
							},
							"Esc": function(cm) {
								if (cm.getOption("fullScreen")) cm.setOption("fullScreen", false);
							}
						}
					});
					fileEditor.setSize("100%",950);
				</script>
			</div>
		</div>
		<script type="text/javascript">
			$('#repoTab .item').tab();
		</script>
	</div>
</div>